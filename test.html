<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>c3demo1</title>
<script src="lib/jquery-3.2.0.min.js"></script>
<script src="lib/city.list.json"></script>
    <!-- Load c3.css -->
<link href="c3-0.4.11/c3-0.4.11/c3.css" rel="stylesheet" type="text/css">
<!-- Load d3.js and c3.js -->
<script src="d3/d3.min.js" charset="utf-8"></script>
<script src="c3-0.4.11/c3-0.4.11/c3.min.js"></script>
<style>
#nav{
  height:80px;
  width: 100%;
  background: orange;
  color:white;
  position: fixed;
  top:0;
  left:0;
  z-index: 1;
}
#chart{
  margin-top:80px;
  background: #fff2e3;
}
</style>
</head>
<body>
<div id="nav">  
<button id="b01" type="button">输入城市名字</button><input id="ipt" value=""></input></button><button id="b02" type="button">清空</button>
</div>
<div id="chart"></div>
</body>
<script>
  $("#b01").click(function(){
    //翻本地json
    var txt = document.getElementById("ipt").value.toString();
         for(var i=0;i<cityList.length;i++){
           if(cityList[i].name===txt){
             var cityCode=cityList[i]._id;
    //ajax拿数据
    $.ajax({
         url:"//api.openweathermap.org/data/2.5/forecast?id="+cityCode+"&APPID=32785e8acc22078c162ee8aedd2307e1",
         dataType:"json",
         cache:"false",
         type:"GET",
         success:function(res){
         //  $("#myDiv").html(JSON.stringify(res));
         //填充数组
         var cityCodeString=String(cityCode);
         window['arr'+cityCode]=[];
         window['arr'+cityCode].push("我是"+cityCodeString);
           for(var j=0;j<res.list.length;j++){
           window['arr'+cityCode].push(res.list[j].main.temp);
           }//for-j
             //绘成图形
             chart.load({
             columns: [
             window['arr'+cityCode]
             ]
             });//chart.load
         }//success
     });//ajax            
    };//if
   };//for-i
  })//click

  //清空
    $("#b02").click(function(){
      chart.unload();
    })

//初始可视化

var bbb=['杭州', 133, 1203, 1103, 1403, 1153, 1253];//预设数组
var chart = c3.generate({
    bindto: '#chart',
    data: {
      columns: [
       bbb
      ],
      type: 'spline'
    }
});
</script>
</html>